<mat-card class="dash-card">
  <div class="dash-header">
    <div class="left">
      <h2 class="title">Overview</h2>
      <div class="muted small">
        Last checked: {{ lastCheckedAt() ? (lastCheckedAt()! | date:'shortTime') : 'â€”' }}
      </div>
    </div>

    <div class="right">
      <button mat-stroked-button (click)="refresh()">
        <mat-icon>refresh</mat-icon>
        Refresh
      </button>
    </div>
  </div>

  <mat-progress-bar *ngIf="inProgress()" mode="determinate" [value]="progressPct()" class="progress"></mat-progress-bar>

  <section class="tiles">
    <div class="tile total">
      <div class="label">Total</div>
      <div class="value">{{ total() }}</div>
    </div>

    <div class="tile up">
      <div class="dot"></div>
      <div class="meta">
        <div class="label">Up</div>
        <div class="value">{{ up() }}</div>
      </div>
    </div>

    <div class="tile warn">
      <div class="dot"></div>
      <div class="meta">
        <div class="label">Degraded</div>
        <div class="value">{{ degraded() }}</div>
      </div>
    </div>

    <div class="tile down">
      <div class="dot"></div>
      <div class="meta">
        <div class="label">Down</div>
        <div class="value">{{ down() }}</div>
      </div>
    </div>

    <div class="tile kpi">
      <div class="label">Success Rate</div>
      <div class="value big">{{ successRate() }}%</div>
    </div>

    <div class="tile kpi">
      <div class="label">Avg Latency</div>
      <div class="value">{{ avgLatency() }} ms</div>
    </div>

    <div class="tile kpi">
      <div class="label">p95 Latency</div>
      <div class="value">{{ p95Latency() }} ms</div>
    </div>
  </section>

  <section class="spark-wrap" *ngIf="latencies().length">
    <div class="spark-title">
      Latency (this sweep)
      <span class="muted">/ {{ latencies().length }} samples</span>
    </div>
    <svg [attr.viewBox]="'0 0 240 48'" class="spark">
      <path [attr.d]="sparkPath()" class="spark-line"></path>
    </svg>
  </section>

  <div class="error" *ngIf="error()">{{ error() }}</div>
</mat-card>
